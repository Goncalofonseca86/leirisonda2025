<!doctype html>
<html lang="pt">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/leirisonda-logo.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- PWA Meta Tags - Force iOS app behavior -->
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta
      name="apple-mobile-web-app-status-bar-style"
      content="black-translucent"
    />
    <meta name="apple-mobile-web-app-title" content="Leirisonda" />
    <meta name="application-name" content="Leirisonda" />
    <meta name="theme-color" content="#007784" />
    <meta
      name="description"
      content="Sistema de gest√£o de obras e manuten√ß√£o de piscinas da Leirisonda"
    />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-touch-fullscreen" content="yes" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="msapplication-tap-highlight" content="no" />

    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json" crossorigin="use-credentials" />

    <!-- iOS Splash Screens -->
    <link
      rel="apple-touch-startup-image"
      media="screen and (device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
      href="/apple-splash-2796-1290.jpg"
    />

    <title>Leirisonda - Gest√£o de Obras</title>

    <style>
      /* CSS ultra-espec√≠fico para esconder DIAGN√ìSTICO */
      *[aria-label="DIAGN√ìSTICO"],
      *[title="DIAGN√ìSTICO"],
      *[data-testid*="diagnostico"],
      div[data-testid*="diagnostico"],
      button[data-testid*="diagnostico"],
      a[data-testid*="diagnostico"],
      [role="button"][aria-label*="diagn√≥stico"],
      [role="button"][aria-label*="DIAGN√ìSTICO"] {
        display: none !important;
        visibility: hidden !important;
        opacity: 0 !important;
        height: 0 !important;
        overflow: hidden !important;
        padding: 0 !important;
        margin: 0 !important;
      }

      /* Destaca ADMINISTRA√á√ÉO */
      *[aria-label="ADMINISTRA√á√ÉO"],
      *[title="ADMINISTRA√á√ÉO"],
      *[data-testid*="administracao"],
      div[data-testid*="administracao"],
      button[data-testid*="administracao"],
      a[data-testid*="administracao"],
      [role="button"][aria-label*="administra√ß√£o"],
      [role="button"][aria-label*="ADMINISTRA√á√ÉO"] {
        background: linear-gradient(
          135deg,
          #fbbf24 0%,
          #f59e0b 100%
        ) !important;
        border-radius: 12px !important;
        padding: 16px !important;
        margin: 8px !important;
        color: #1f2937 !important;
        font-weight: bold !important;
        box-shadow: 0 4px 20px rgba(251, 191, 36, 0.3) !important;
        border: 2px solid #f59e0b !important;
      }

      /* For√ßa todos os elementos filhos tamb√©m */
      *[aria-label="ADMINISTRA√á√ÉO"] *,
      *[title="ADMINISTRA√á√ÉO"] *,
      *[data-testid*="administracao"] *,
      div[data-testid*="administracao"] *,
      button[data-testid*="administracao"] *,
      a[data-testid*="administracao"] * {
        color: #1f2937 !important;
      }
    </style>

    <script>
      // Script espec√≠fico para detectar abertura do menu lateral
      console.log("üéØ Detectando abertura do menu lateral...");

      let menuModified = false;
      let checkCount = 0;

      function detectAndModifyMenu() {
        checkCount++;
        console.log(`üîç Verifica√ß√£o #${checkCount}`);

        // Procura por elementos espec√≠ficos do menu
        const allElements = document.querySelectorAll("*");
        let menuDetected = false;

        for (let element of allElements) {
          const text = element.textContent || "";

          // Verifica se o menu est√° vis√≠vel e cont√©m os itens esperados
          if (
            text.includes("Dashboard") &&
            text.includes("DIAGN√ìSTICO") &&
            text.includes("ADMINISTRA√á√ÉO") &&
            text.includes("Utilizadores")
          ) {
            menuDetected = true;
            console.log("üìã Menu lateral detectado!", element);

            if (!menuModified) {
              modifyMenuNow(element);
              menuModified = true;
            }
            break;
          }
        }

        // Se n√£o detectou o menu, continua a procurar
        if (!menuDetected && checkCount < 100) {
          setTimeout(detectAndModifyMenu, 500);
        }
      }

      function modifyMenuNow(menuContainer) {
        console.log("‚ö° Aplicando modifica√ß√µes agora!");

        // Encontra e modifica todos os elementos dentro do menu
        const menuElements = menuContainer.querySelectorAll("*");
        let changes = 0;

        menuElements.forEach((element) => {
          const text = element.textContent || "";

          // Remove DIAGN√ìSTICO
          if (
            text.trim() === "DIAGN√ìSTICO" ||
            (text.includes("DIAGN√ìSTICO") && text.length < 50)
          ) {
            // Encontra o elemento clic√°vel/container
            let target = element;
            while (
              target.parentElement &&
              target.parentElement !== menuContainer &&
              target.parentElement.children.length <= 2
            ) {
              target = target.parentElement;
            }

            target.style.setProperty("display", "none", "important");
            target.style.setProperty("visibility", "hidden", "important");
            target.style.setProperty("opacity", "0", "important");
            target.style.setProperty("height", "0px", "important");
            target.style.setProperty("overflow", "hidden", "important");
            target.style.setProperty("padding", "0", "important");
            target.style.setProperty("margin", "0", "important");

            console.log("üóëÔ∏è DIAGN√ìSTICO removido:", target);
            changes++;
          }

          // Destaca ADMINISTRA√á√ÉO
          if (
            text.trim() === "ADMINISTRA√á√ÉO" ||
            (text.includes("ADMINISTRA√á√ÉO") && text.length < 50)
          ) {
            // Encontra o elemento clic√°vel/container
            let target = element;
            while (
              target.parentElement &&
              target.parentElement !== menuContainer &&
              target.parentElement.children.length <= 2
            ) {
              target = target.parentElement;
            }

            target.style.setProperty(
              "background",
              "linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%)",
              "important",
            );
            target.style.setProperty("border-radius", "12px", "important");
            target.style.setProperty("padding", "16px", "important");
            target.style.setProperty("margin", "8px", "important");
            target.style.setProperty("color", "#1f2937", "important");
            target.style.setProperty("font-weight", "bold", "important");
            target.style.setProperty(
              "box-shadow",
              "0 4px 20px rgba(251, 191, 36, 0.3)",
              "important",
            );
            target.style.setProperty(
              "border",
              "2px solid #f59e0b",
              "important",
            );

            // For√ßa cor dos filhos
            const children = target.querySelectorAll("*");
            children.forEach((child) => {
              child.style.setProperty("color", "#1f2937", "important");
            });

            console.log("‚≠ê ADMINISTRA√á√ÉO destacada:", target);
            changes++;
          }
        });

        // Mostra notifica√ß√£o de sucesso
        if (changes > 0) {
          showSuccessMessage(changes);
        }
      }

      function showSuccessMessage(changes) {
        // Remove mensagem anterior
        const existing = document.getElementById("menu-success");
        if (existing) existing.remove();

        const message = document.createElement("div");
        message.id = "menu-success";
        message.style.cssText = `
          position: fixed;
          top: 20px;
          right: 20px;
          background: #10b981;
          color: white;
          padding: 12px 20px;
          border-radius: 8px;
          z-index: 99999;
          font-size: 14px;
          font-weight: bold;
          box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        `;
        message.textContent = `‚úÖ Menu modificado! (${changes} altera√ß√µes)`;

        document.body.appendChild(message);

        setTimeout(() => {
          if (message.parentElement) {
            message.remove();
          }
        }, 5000);
      }

      // Detecta cliques no bot√£o do menu (3 tra√ßos)
      document.addEventListener("click", (event) => {
        const target = event.target;

        // Se clicou num bot√£o que pode ser o menu hamburger
        if (target.tagName === "BUTTON" || target.closest("button")) {
          console.log("üîò Clique detectado, verificando se √© o menu...");
          setTimeout(() => {
            menuModified = false; // Reset para permitir nova detec√ß√£o
            detectAndModifyMenu();
          }, 200);
        }
      });

      // Observer para mudan√ßas no DOM (quando menu aparece)
      const observer = new MutationObserver((mutations) => {
        mutations.forEach((mutation) => {
          if (mutation.type === "childList" && mutation.addedNodes.length > 0) {
            mutation.addedNodes.forEach((node) => {
              if (node.nodeType === 1) {
                // Element node
                const text = node.textContent || "";
                if (
                  text.includes("DIAGN√ìSTICO") &&
                  text.includes("ADMINISTRA√á√ÉO")
                ) {
                  console.log("üìã Menu apareceu via MutationObserver");
                  setTimeout(() => {
                    menuModified = false;
                    detectAndModifyMenu();
                  }, 100);
                }
              }
            });
          }
        });
      });

      // Inicia observa√ß√£o
      if (document.body) {
        observer.observe(document.body, {
          childList: true,
          subtree: true,
        });
      }

      // Tenta detectar o menu periodicamente
      const interval = setInterval(() => {
        if (!menuModified) {
          detectAndModifyMenu();
        }
      }, 2000);

      // Para o interval ap√≥s 2 minutos
      setTimeout(() => {
        clearInterval(interval);
      }, 120000);

      console.log("üöÄ Script de detec√ß√£o do menu iniciado");
    </script>

    <script type="module" crossorigin src="/assets/index-DnEsHg1H.js"></script>
    <link rel="stylesheet" crossorigin href="/assets/index-DFdR-byQ.css" />
  </head>
  <body>
    <div id="root"></div>

    <script>
      // Essential protection and service worker
      if ("serviceWorker" in navigator) {
        navigator.serviceWorker.register("/sw.js");
      }

      // Auto-redirect removed to prevent 404 errors
    </script>
  </body>
</html>
